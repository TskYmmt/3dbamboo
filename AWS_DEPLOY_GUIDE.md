# AWS Amplifyデプロイガイド

## 必要な準備

### 1. AWSアカウント
- AWSアカウントを作成（https://aws.amazon.com/jp/）
- クレジットカード登録が必要（無料枠あり）

### 2. GitHubリポジトリ
- 現在のコードがGitHubにプッシュされていることを確認

## デプロイ手順

### ステップ1: AWS Amplifyコンソールにアクセス
1. AWSコンソールにログイン
2. 「Amplify」サービスを検索して開く
3. 「新しいアプリケーション」→「ウェブアプリケーションをホスト」をクリック

### ステップ2: GitHubと連携
1. 「GitHub」を選択して「続行」
2. GitHubアカウントで認証
3. リポジトリ「3dbamboo」を選択
4. ブランチ「master」を選択

### ステップ3: ビルド設定
1. Amplifyが自動的にamplify.ymlを検出
2. 「アプリケーション名」を入力（例：tanabata-3d）
3. 「新しい環境を作成」を選択

### ステップ4: 環境変数の設定
以下の環境変数を追加：
- `NODE_ENV`: production
- `PORT`: 3000（Amplifyが自動設定）

### ステップ5: デプロイ
1. 「保存してデプロイ」をクリック
2. デプロイが完了するまで待つ（約5-10分）
3. 完了後、提供されたURLでアプリにアクセス

## 重要な設定変更

### データ永続化の対応
現在のJSONファイル保存は、AWS Amplifyでは永続化されません。以下の対応が必要：

#### オプション1: Amazon S3を使用（推奨）
```javascript
// server.jsを修正してS3にデータを保存
const AWS = require('aws-sdk');
const s3 = new AWS.S3();

// tanzaku_data.jsonの代わりにS3を使用
```

#### オプション2: DynamoDBを使用
- Amplify CLIでDynamoDBテーブルを作成
- server.jsをDynamoDB対応に修正

### 静的ファイルの配信
現在の設定で静的ファイル（HTML、CSS、JS、画像）は自動的に配信されます。

## コスト見積もり
- **無料枠**: 
  - ビルド時間: 月1000分無料
  - ホスティング: 月15GBストレージ、15GB転送量無料
- **推定月額**: 小規模利用なら無料枠内で収まる可能性大

## トラブルシューティング

### ビルドエラーの場合
1. Amplifyコンソールでビルドログを確認
2. package.jsonの依存関係を確認
3. Node.jsバージョンを指定（必要に応じて）

### APIが動作しない場合
1. 環境変数が正しく設定されているか確認
2. server.jsのポート設定を確認
3. CORSの設定を確認

## 次のステップ
1. カスタムドメインの設定（Route 53を使用）
2. SSL証明書の設定（Amplifyが自動提供）
3. モニタリングとアラートの設定（CloudWatch）